apiVersion: v1
kind: Pod
metadata:
  name: test-kata-qemu-workload-1
  annotations:
    io.containerd.cri.runtime-handler: kata-qemu-workload
spec:
  runtimeClassName: kata-qemu-workload
  volumes:
  - name: fs-manager
    emptyDir:
      medium: Memory
  - name: metadata-db
    emptyDir:
      medium: Memory
  - name: test-shared-data
    emptyDir:
      medium: Memory
  - name: host-share-v
    hostPath:
      path: /run/kata-containers/my-share
      type: DirectoryOrCreate
  initContainers:
    - name: init-c
      image: busybox
      imagePullPolicy: Always
      command: [ "sh","-c","sleep 1" ]
      env:
        - name: controllerCrpToken
          value: "eyJhbGciOiJFUzI1NiIsImtpZCI6ImticzovLy8weGFjMDYxOGYwYjEwNWZhZjE3YjhlMTM3MGY5OGZlYmRiMmUxZmZjNWIvZWNzay8xODc5NzIxOTkwIiwidHlwIjoiSldUIiwidmVyIjoiMSJ9.eyJpYXQiOjE3MTI1Njc5MTEsImF1dGhvcml6ZWRfcmVzIjpbeyJleHAiOjE3MjEyMDc5MTEsInJlcyI6ImticzovLy8weGFjMDYxOGYwYjEwNWZhZjE3YjhlMTM3MGY5OGZlYmRiMmUxZmZjNWIvZWNzay8qIn0seyJleHAiOjE3MjEyMDc5MTEsInJlcyI6ImticzovLy8weGFjMDYxOGYwYjEwNWZhZjE3YjhlMTM3MGY5OGZlYmRiMmUxZmZjNWIvaXZwL01USXdNemN4TURRME9IeGtiMk5yWlhJdWFXOHZaVzUxYjJOdEwySjFjM2xpYjNnNlpXNWpjbmx3ZEdWayJ9LHsiZXhwIjoxNzIxMjA3OTExLCJyZXMiOiJrYnM6Ly8vMHhhYzA2MThmMGIxMDVmYWYxN2I4ZTEzNzBmOThmZWJkYjJlMWZmYzViLyovKiJ9XSwicnVudGltZV9yZXMiOnsiZnMtbWFuYWdlciI6eyJrYnM6Ly8vMHhhYzA2MThmMGIxMDVmYWYxN2I4ZTEzNzBmOThmZWJkYjJlMWZmYzViL2NlcnRzL2NsaWVudCI6Ii9ydW4va2F0YS1jb250YWluZXJzL3NhbmRib3gvZXBoZW1lcmFsL2ZzLW1hbmFnZXIvY2VydHMvIiwia2JzOi8vLzB4YWMwNjE4ZjBiMTA1ZmFmMTdiOGUxMzcwZjk4ZmViZGIyZTFmZmM1Yi9jZXJ0cy9zZXJ2ZXIiOiIvcnVuL2thdGEtY29udGFpbmVycy9zYW5kYm94L2VwaGVtZXJhbC9mcy1tYW5hZ2VyL2NlcnRzLyIsImticzovLy8weGFjMDYxOGYwYjEwNWZhZjE3YjhlMTM3MGY5OGZlYmRiMmUxZmZjNWIvZnNyay8wIjoiL3J1bi9rYXRhLWNvbnRhaW5lcnMvc2FuZGJveC9lcGhlbWVyYWwvZnMtbWFuYWdlci9rZXlzL2ZzcmsifSwibWV0YWRhdGEtZGIiOnsia2JzOi8vLzB4YWMwNjE4ZjBiMTA1ZmFmMTdiOGUxMzcwZjk4ZmViZGIyZTFmZmM1Yi9jZXJ0cy9zZXJ2ZXIiOiIvcnVuL2thdGEtY29udGFpbmVycy9zYW5kYm94L2VwaGVtZXJhbC9tZXRhZGF0YS1kYi9jZXJ0cy8ifX19.8K_NDIaYzXs0UOlpdYsMumSgWikzT8Wl_aC94fNDewEf_LW-BeUKh0Wc_BGPBBxSd8BGPfhZKEXzOCVWHTZJ_g"
        - name: controllerAttestationReport
          value: "eyJ2ZXJzaW9uIjowLCJndWVzdF9zdm4iOjQyOTQ5NjcyOTUsInBvbGljeSI6MCwiZmFtaWx5X2lkIjpbMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMF0sImltYWdlX2lkIjpbMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMF0sInZtcGwiOjAsInNpZ19hbGdvIjowLCJjdXJyZW50X3RjYiI6eyJib290bG9hZGVyIjowLCJ0ZWUiOjAsIl9yZXNlcnZlZCI6WzAsMCwwLDBdLCJzbnAiOjAsIm1pY3JvY29kZSI6MH0sInBsYXRfaW5mbyI6MCwiX2F1dGhvcl9rZXlfZW4iOjAsIl9yZXNlcnZlZF8wIjowLCJyZXBvcnRfZGF0YSI6WzI1MSwyMjksMjA5LDE2MCw2NCwxMjAsNDIsMTkzLDcwLDEzMSwxNTUsMjM0LDEyOSwyMjUsMTM2LDEyNiwxNDAsMTEwLDk0LDkxLDAsMjQyLDUwLDEyMCwxODIsMjA0LDEyOSwxMjYsMTI4LDg3LDIwMCw5NiwxMDYsMTEwLDMsMTYxLDg5LDIyMiwyNDEsNDQsMTY4LDQ3LDIxMywxOTUsNzIsMTk0LDE1MiwxMTcsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMF0sIm1lYXN1cmVtZW50IjpbNjAsMTA1LDE1LDE5Myw5NSwxMzEsODgsMTA2LDg5LDIzNSwxMzMsNjMsMywxNzYsMjE3LDczLDE2LDEwNiwxMjIsMTU0LDQyLDI1NCwxNDQsMTc0LDIzOCwxNjMsMjAsNzgsMTkzLDc0LDM3LDg0LDIxMCwyMzEsMSw5MCwyMzgsMjEyLDIyLDEyMiwxNzYsNzYsMTkxLDIyOCwxNTAsMTcyLDE1OCw1XSwiaG9zdF9kYXRhIjpbMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwXSwiaWRfa2V5X2RpZ2VzdCI6WzAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwXSwiYXV0aG9yX2tleV9kaWdlc3QiOlswLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMF0sInJlcG9ydF9pZCI6WzAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMF0sInJlcG9ydF9pZF9tYSI6WzAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMF0sInJlcG9ydGVkX3RjYiI6eyJib290bG9hZGVyIjowLCJ0ZWUiOjAsIl9yZXNlcnZlZCI6WzAsMCwwLDBdLCJzbnAiOjAsIm1pY3JvY29kZSI6MH0sIl9yZXNlcnZlZF8xIjpbMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDBdLCJjaGlwX2lkIjpbMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMF0sImNvbW1pdHRlZF90Y2IiOnsiYm9vdGxvYWRlciI6MCwidGVlIjowLCJfcmVzZXJ2ZWQiOlswLDAsMCwwXSwic25wIjowLCJtaWNyb2NvZGUiOjB9LCJjdXJyZW50X2J1aWxkIjowLCJjdXJyZW50X21pbm9yIjowLCJjdXJyZW50X21ham9yIjowLCJfcmVzZXJ2ZWRfMiI6MCwiY29tbWl0dGVkX2J1aWxkIjowLCJjb21taXR0ZWRfbWlub3IiOjAsImNvbW1pdHRlZF9tYWpvciI6MCwiX3Jlc2VydmVkXzMiOjAsImxhdW5jaF90Y2IiOnsiYm9vdGxvYWRlciI6MCwidGVlIjowLCJfcmVzZXJ2ZWQiOlswLDAsMCwwXSwic25wIjowLCJtaWNyb2NvZGUiOjB9LCJfcmVzZXJ2ZWRfNCI6WzAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwXSwic2lnbmF0dXJlIjp7InIiOlswLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMF0sInMiOlswLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMF0sIl9yZXNlcnZlZCI6WzAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMF19fQ=="
        - name: controllerCertChain
          value: "W3siY2VydF90eXBlIjoiRW1wdHkiLCJkYXRhIjpbXX1d"
  containers:
  - name: fs-manager
    image: hub.confidentialfilesystems.com/cc/juicefs:v1.1.2-d3
    imagePullPolicy: Always
    volumeMounts:
      - name: fs-manager
        mountPath: /data/fs
      - name: host-share-v
        mountPath: /data/my-share
      - name: test-shared-data
        mountPath: /data1
        mountPropagation: Bidirectional
    securityContext:
      privileged: true
    command:
      - "sh"
      - "-c"
      - "sleep 10000"
  - name: metadata-db
    #image: hub.confidentialfilesystems.com/cc/workload/busybox:test-encrypted
    image: hub.confidentialfilesystems.com/cc/cfs-benchmark:v0.0.2-encrypted
    imagePullPolicy: Always
    volumeMounts:
      - name: metadata-db
        mountPath: /data/meta
      - name: test-shared-data
        mountPath: /data2
        mountPropagation: Bidirectional
    securityContext:
      privileged: true
    command:
      - "bin/sh"
      - "-c"
      - "sleep 10000"
#